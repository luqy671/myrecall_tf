nohup: ignoring input
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:108: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

['src/train.py', '--dataset', 'elec', '--model_type', 'ComiRec-SA']
WARNING:tensorflow:From src/train.py:343: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From src/train.py:221: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From src/train.py:227: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From src/train.py:227: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2022-05-14 12:27:45.383888: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2022-05-14 12:27:45.427272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz
2022-05-14 12:27:45.432513: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562e56631640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-05-14 12:27:45.432599: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-05-14 12:27:45.437012: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2022-05-14 12:27:45.606572: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562e565c4870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-05-14 12:27:45.606653: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA TITAN RTX, Compute Capability 7.5
2022-05-14 12:27:45.607668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: NVIDIA TITAN RTX major: 7 minor: 5 memoryClockRate(GHz): 1.77
pciBusID: 0000:1a:00.0
2022-05-14 12:27:45.608073: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-05-14 12:27:45.609714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2022-05-14 12:27:45.612454: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2022-05-14 12:27:45.612952: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2022-05-14 12:27:45.616078: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2022-05-14 12:27:45.617907: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2022-05-14 12:27:45.624075: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-05-14 12:27:45.625331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2022-05-14 12:27:45.625385: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-05-14 12:27:45.626458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-14 12:27:45.626480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2022-05-14 12:27:45.626492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2022-05-14 12:27:45.627712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22855 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN RTX, pci bus id: 0000:1a:00.0, compute capability: 7.5)
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:16: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:27: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:228: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:228: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:229: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:236: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:39: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From src/train.py:233: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From src/train.py:234: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

training begin
2022-05-14 12:28:01.873657: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
default_9
iter: 1000, train loss: 8.1656, valid recall: 0.041214, valid ndcg: 0.034962, valid hitrate: 0.074386
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:66: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

time interval: 0.4439 min
default_9
iter: 2000, train loss: 7.6254, valid recall: 0.044067, valid ndcg: 0.040122, valid hitrate: 0.081537
time interval: 0.8715 min
default_9
iter: 3000, train loss: 7.1473, valid recall: 0.046813, valid ndcg: 0.043131, valid hitrate: 0.085134
time interval: 1.2981 min
default_9
iter: 4000, train loss: 6.8412, valid recall: 0.049094, valid ndcg: 0.047088, valid hitrate: 0.089073
time interval: 1.7298 min
default_9
iter: 5000, train loss: 6.6507, valid recall: 0.052143, valid ndcg: 0.051090, valid hitrate: 0.094811
time interval: 2.1839 min
default_9
iter: 6000, train loss: 6.5445, valid recall: 0.053422, valid ndcg: 0.052498, valid hitrate: 0.096788
time interval: 2.6403 min
default_9
iter: 7000, train loss: 6.4630, valid recall: 0.055584, valid ndcg: 0.054916, valid hitrate: 0.100988
time interval: 3.1003 min
default_9
iter: 8000, train loss: 6.4060, valid recall: 0.055617, valid ndcg: 0.055647, valid hitrate: 0.100412
time interval: 3.5729 min
default_9
iter: 9000, train loss: 6.3502, valid recall: 0.056789, valid ndcg: 0.056270, valid hitrate: 0.102718
time interval: 4.0399 min
default_9
iter: 10000, train loss: 6.3109, valid recall: 0.057822, valid ndcg: 0.057452, valid hitrate: 0.104859
time interval: 4.5102 min
default_9
iter: 11000, train loss: 6.2640, valid recall: 0.058290, valid ndcg: 0.057855, valid hitrate: 0.104914
time interval: 4.9808 min
default_9
iter: 12000, train loss: 6.2223, valid recall: 0.059074, valid ndcg: 0.058293, valid hitrate: 0.106191
time interval: 5.4552 min
default_9
iter: 13000, train loss: 6.1865, valid recall: 0.059744, valid ndcg: 0.058824, valid hitrate: 0.107440
time interval: 5.9307 min
default_9
iter: 14000, train loss: 6.1477, valid recall: 0.060314, valid ndcg: 0.059010, valid hitrate: 0.107522
time interval: 6.4049 min
default_9
iter: 15000, train loss: 6.1072, valid recall: 0.060634, valid ndcg: 0.059428, valid hitrate: 0.108730
time interval: 6.8850 min
default_9
iter: 16000, train loss: 6.0651, valid recall: 0.061232, valid ndcg: 0.059795, valid hitrate: 0.109691
time interval: 7.3625 min
default_9
iter: 17000, train loss: 6.0356, valid recall: 0.061890, valid ndcg: 0.060642, valid hitrate: 0.110323
time interval: 7.8404 min
default_9
iter: 18000, train loss: 6.0068, valid recall: 0.062295, valid ndcg: 0.060854, valid hitrate: 0.110803
time interval: 8.3174 min
default_9
iter: 19000, train loss: 5.9703, valid recall: 0.063145, valid ndcg: 0.061494, valid hitrate: 0.112148
time interval: 8.7947 min
default_9
iter: 20000, train loss: 5.9429, valid recall: 0.063374, valid ndcg: 0.061981, valid hitrate: 0.113068
time interval: 9.2758 min
default_9
iter: 21000, train loss: 5.9052, valid recall: 0.063194, valid ndcg: 0.061454, valid hitrate: 0.112286
time interval: 9.7525 min
default_9
iter: 22000, train loss: 5.8671, valid recall: 0.064013, valid ndcg: 0.061764, valid hitrate: 0.114152
time interval: 10.2368 min
default_9
iter: 23000, train loss: 5.8348, valid recall: 0.064400, valid ndcg: 0.061968, valid hitrate: 0.114550
time interval: 10.7171 min
default_9
iter: 24000, train loss: 5.8067, valid recall: 0.064277, valid ndcg: 0.061807, valid hitrate: 0.113946
time interval: 11.1924 min
default_9
iter: 25000, train loss: 5.7787, valid recall: 0.064771, valid ndcg: 0.061329, valid hitrate: 0.115209
time interval: 11.6758 min
default_9
iter: 26000, train loss: 5.7454, valid recall: 0.064851, valid ndcg: 0.061704, valid hitrate: 0.115278
time interval: 12.1646 min
default_9
iter: 27000, train loss: 5.7135, valid recall: 0.064725, valid ndcg: 0.061675, valid hitrate: 0.115072
time interval: 12.6440 min
default_9
iter: 28000, train loss: 5.6868, valid recall: 0.065386, valid ndcg: 0.062090, valid hitrate: 0.115964
time interval: 13.1292 min
default_9
iter: 29000, train loss: 5.6539, valid recall: 0.065454, valid ndcg: 0.061414, valid hitrate: 0.116047
time interval: 13.6142 min
default_9
iter: 30000, train loss: 5.6066, valid recall: 0.065528, valid ndcg: 0.061675, valid hitrate: 0.115937
time interval: 14.0998 min
default_9
iter: 31000, train loss: 5.5726, valid recall: 0.065552, valid ndcg: 0.061664, valid hitrate: 0.116033
time interval: 14.5888 min
default_9
iter: 32000, train loss: 5.5496, valid recall: 0.065652, valid ndcg: 0.061825, valid hitrate: 0.116143
time interval: 15.0786 min
default_9
iter: 33000, train loss: 5.5278, valid recall: 0.066020, valid ndcg: 0.061334, valid hitrate: 0.116815
time interval: 15.5659 min
default_9
iter: 34000, train loss: 5.4859, valid recall: 0.066342, valid ndcg: 0.061617, valid hitrate: 0.117090
time interval: 16.0497 min
default_9
iter: 35000, train loss: 5.4697, valid recall: 0.066055, valid ndcg: 0.061294, valid hitrate: 0.116953
time interval: 16.5311 min
default_9
iter: 36000, train loss: 5.4338, valid recall: 0.066164, valid ndcg: 0.061312, valid hitrate: 0.116527
time interval: 17.0115 min
default_9
iter: 37000, train loss: 5.4120, valid recall: 0.066429, valid ndcg: 0.061729, valid hitrate: 0.117817
time interval: 17.5013 min
default_9
iter: 38000, train loss: 5.3766, valid recall: 0.065975, valid ndcg: 0.060708, valid hitrate: 0.116445
time interval: 17.9811 min
default_9
iter: 39000, train loss: 5.3371, valid recall: 0.066436, valid ndcg: 0.060892, valid hitrate: 0.117186
time interval: 18.4676 min
default_9
iter: 40000, train loss: 5.3192, valid recall: 0.066520, valid ndcg: 0.060981, valid hitrate: 0.116706
time interval: 18.9505 min
default_9
iter: 41000, train loss: 5.2845, valid recall: 0.066502, valid ndcg: 0.059981, valid hitrate: 0.116747
time interval: 19.4261 min
default_9
iter: 42000, train loss: 5.2601, valid recall: 0.066602, valid ndcg: 0.060128, valid hitrate: 0.116911
time interval: 19.9160 min
default_9
iter: 43000, train loss: 5.2411, valid recall: 0.066332, valid ndcg: 0.060303, valid hitrate: 0.115923
time interval: 20.4005 min
default_9
iter: 44000, train loss: 5.2067, valid recall: 0.066570, valid ndcg: 0.059875, valid hitrate: 0.116884
time interval: 20.8817 min
default_9
iter: 45000, train loss: 5.1808, valid recall: 0.066460, valid ndcg: 0.059490, valid hitrate: 0.116692
time interval: 21.3616 min
default_9
iter: 46000, train loss: 5.1586, valid recall: 0.066263, valid ndcg: 0.059352, valid hitrate: 0.116349
time interval: 21.8478 min
default_9
iter: 47000, train loss: 5.1271, valid recall: 0.066571, valid ndcg: 0.059530, valid hitrate: 0.117351
time interval: 22.3322 min
default_9
iter: 48000, train loss: 5.1081, valid recall: 0.066545, valid ndcg: 0.058665, valid hitrate: 0.116568
time interval: 22.8154 min
default_9
iter: 49000, train loss: 5.0758, valid recall: 0.066415, valid ndcg: 0.058988, valid hitrate: 0.116733
time interval: 23.2994 min
default_9
iter: 50000, train loss: 5.0672, valid recall: 0.066557, valid ndcg: 0.058585, valid hitrate: 0.116486
time interval: 23.7878 min
default_9
iter: 51000, train loss: 5.0228, valid recall: 0.066184, valid ndcg: 0.058033, valid hitrate: 0.115841
time interval: 24.2788 min
default_9
iter: 52000, train loss: 5.0107, valid recall: 0.066125, valid ndcg: 0.057898, valid hitrate: 0.115717
time interval: 24.7717 min
default_9
iter: 53000, train loss: 4.9875, valid recall: 0.066445, valid ndcg: 0.057378, valid hitrate: 0.116307
time interval: 25.2626 min
default_9
iter: 54000, train loss: 4.9665, valid recall: 0.066119, valid ndcg: 0.057355, valid hitrate: 0.115690
time interval: 25.7518 min
default_9
iter: 55000, train loss: 4.9317, valid recall: 0.066003, valid ndcg: 0.056590, valid hitrate: 0.116074
time interval: 26.2418 min
default_9
iter: 56000, train loss: 4.9269, valid recall: 0.065959, valid ndcg: 0.056780, valid hitrate: 0.115594
time interval: 26.7286 min
default_9
iter: 57000, train loss: 4.9117, valid recall: 0.065944, valid ndcg: 0.056324, valid hitrate: 0.115553
time interval: 27.2175 min
default_9
iter: 58000, train loss: 4.8829, valid recall: 0.065825, valid ndcg: 0.056134, valid hitrate: 0.115264
time interval: 27.7051 min
default_9
iter: 59000, train loss: 4.8559, valid recall: 0.065999, valid ndcg: 0.055122, valid hitrate: 0.115649
time interval: 28.1865 min
default_9
iter: 60000, train loss: 4.8410, valid recall: 0.065569, valid ndcg: 0.055623, valid hitrate: 0.114660
time interval: 28.6536 min
default_9
iter: 61000, train loss: 4.8260, valid recall: 0.065492, valid ndcg: 0.055431, valid hitrate: 0.114441
time interval: 29.1190 min
default_9
iter: 62000, train loss: 4.7982, valid recall: 0.065586, valid ndcg: 0.054849, valid hitrate: 0.114152
time interval: 29.5829 min
default_9
iter: 63000, train loss: 4.7895, valid recall: 0.065009, valid ndcg: 0.054364, valid hitrate: 0.113768
time interval: 30.0497 min
default_9
iter: 64000, train loss: 4.7804, valid recall: 0.065010, valid ndcg: 0.053953, valid hitrate: 0.113260
time interval: 30.5160 min
default_9
iter: 65000, train loss: 4.7629, valid recall: 0.064884, valid ndcg: 0.053993, valid hitrate: 0.112807
time interval: 30.9817 min
default_9
iter: 66000, train loss: 4.7440, valid recall: 0.064170, valid ndcg: 0.053318, valid hitrate: 0.111668
time interval: 31.4466 min
default_9
iter: 67000, train loss: 4.7196, valid recall: 0.064771, valid ndcg: 0.053352, valid hitrate: 0.112889
time interval: 31.9102 min
default_9
iter: 68000, train loss: 4.7124, valid recall: 0.064986, valid ndcg: 0.052500, valid hitrate: 0.113548
time interval: 32.3776 min
default_9
iter: 69000, train loss: 4.6973, valid recall: 0.065383, valid ndcg: 0.053272, valid hitrate: 0.114056
time interval: 32.8445 min
default_9
iter: 70000, train loss: 4.6963, valid recall: 0.065090, valid ndcg: 0.053103, valid hitrate: 0.113439
time interval: 33.3333 min
default_9
iter: 71000, train loss: 4.6702, valid recall: 0.064717, valid ndcg: 0.052007, valid hitrate: 0.112286
time interval: 33.8307 min
default_9
iter: 72000, train loss: 4.6437, valid recall: 0.064741, valid ndcg: 0.052699, valid hitrate: 0.112505
time interval: 34.3368 min
default_9
iter: 73000, train loss: 4.6381, valid recall: 0.064870, valid ndcg: 0.052075, valid hitrate: 0.112889
time interval: 34.8528 min
default_9
iter: 74000, train loss: 4.6203, valid recall: 0.064697, valid ndcg: 0.052174, valid hitrate: 0.112135
time interval: 35.3574 min
default_9
iter: 75000, train loss: 4.6287, valid recall: 0.064995, valid ndcg: 0.052189, valid hitrate: 0.113370
time interval: 35.8532 min
default_9
iter: 76000, train loss: 4.6032, valid recall: 0.064623, valid ndcg: 0.051658, valid hitrate: 0.112725
time interval: 36.3466 min
default_9
iter: 77000, train loss: 4.6002, valid recall: 0.064291, valid ndcg: 0.051352, valid hitrate: 0.111778
time interval: 36.8307 min
default_9
iter: 78000, train loss: 4.5764, valid recall: 0.064392, valid ndcg: 0.051374, valid hitrate: 0.112066
time interval: 37.3118 min
default_9
iter: 79000, train loss: 4.5638, valid recall: 0.063930, valid ndcg: 0.051513, valid hitrate: 0.111531
time interval: 37.7927 min
default_9
iter: 80000, train loss: 4.5650, valid recall: 0.063881, valid ndcg: 0.051044, valid hitrate: 0.110872
time interval: 38.2671 min
default_9
iter: 81000, train loss: 4.5449, valid recall: 0.064064, valid ndcg: 0.050258, valid hitrate: 0.111544
time interval: 38.7542 min
default_9
iter: 82000, train loss: 4.5378, valid recall: 0.063902, valid ndcg: 0.050661, valid hitrate: 0.111229
time interval: 39.2429 min
default_9
iter: 83000, train loss: 4.5146, valid recall: 0.063732, valid ndcg: 0.050262, valid hitrate: 0.110679
time interval: 39.7425 min
default_9
iter: 84000, train loss: 4.5069, valid recall: 0.064215, valid ndcg: 0.050026, valid hitrate: 0.111489
time interval: 40.2503 min
default_9
iter: 85000, train loss: 4.4986, valid recall: 0.063429, valid ndcg: 0.049740, valid hitrate: 0.110350
time interval: 40.7659 min
default_9
iter: 86000, train loss: 4.5028, valid recall: 0.063871, valid ndcg: 0.049703, valid hitrate: 0.110981
time interval: 41.2720 min
default_9
iter: 87000, train loss: 4.4947, valid recall: 0.063537, valid ndcg: 0.049115, valid hitrate: 0.110295
time interval: 41.7843 min
default_9
iter: 88000, train loss: 4.4745, valid recall: 0.063183, valid ndcg: 0.049182, valid hitrate: 0.109458
time interval: 42.2849 min
default_9
iter: 89000, train loss: 4.4785, valid recall: 0.063449, valid ndcg: 0.048978, valid hitrate: 0.109938
time interval: 42.7738 min
default_9
iter: 90000, train loss: 4.4590, valid recall: 0.063066, valid ndcg: 0.049276, valid hitrate: 0.109417
time interval: 43.2546 min
default_9
iter: 91000, train loss: 4.4593, valid recall: 0.063474, valid ndcg: 0.049293, valid hitrate: 0.110625
time interval: 43.7353 min
default_9
iter: 92000, train loss: 4.4577, valid recall: 0.062901, valid ndcg: 0.048166, valid hitrate: 0.108730
time interval: 44.2144 min
default_9
iter: 93000, train loss: 4.4442, valid recall: 0.062779, valid ndcg: 0.048770, valid hitrate: 0.109183
model restored from best_model/default_9/
valid recall: 0.066602, valid ndcg: 0.060128, valid hitrate: 0.116911, valid diversity: 0.000000
test recall: 0.065116, test ndcg: 0.059243, test hitrate: 0.114962, test diversity: 0.000000
