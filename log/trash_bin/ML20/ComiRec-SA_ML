nohup: ignoring input
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:108: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

['src/train.py', '--dataset', 'ML', '--model_type', 'ComiRec-SA']
WARNING:tensorflow:From src/train.py:343: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From src/train.py:221: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From src/train.py:227: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From src/train.py:227: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2022-05-13 08:55:38.349406: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2022-05-13 08:55:38.390961: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz
2022-05-13 08:55:38.394979: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559be6c6db60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-05-13 08:55:38.395045: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-05-13 08:55:38.398708: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2022-05-13 08:55:38.603681: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559be69b69d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-05-13 08:55:38.603768: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA TITAN RTX, Compute Capability 7.5
2022-05-13 08:55:38.604918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: NVIDIA TITAN RTX major: 7 minor: 5 memoryClockRate(GHz): 1.77
pciBusID: 0000:1a:00.0
2022-05-13 08:55:38.605374: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-05-13 08:55:38.606886: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2022-05-13 08:55:38.609406: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2022-05-13 08:55:38.609851: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2022-05-13 08:55:38.612505: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2022-05-13 08:55:38.613948: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2022-05-13 08:55:38.619497: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-05-13 08:55:38.621260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2022-05-13 08:55:38.621331: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-05-13 08:55:38.622484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-13 08:55:38.622509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2022-05-13 08:55:38.622521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2022-05-13 08:55:38.623900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22855 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN RTX, pci bus id: 0000:1a:00.0, compute capability: 7.5)
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:16: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:27: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:228: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:228: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:229: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /mistgpu/miniconda/envs/env1/lib/python3.6/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:236: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:39: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From src/train.py:233: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From src/train.py:234: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

training begin
2022-05-13 08:56:18.422637: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
default_13
iter: 1000, train loss: 7.1153, valid recall: 0.223241, valid ndcg: 0.361920, valid hitrate: 0.812333
WARNING:tensorflow:From /home/mist/ComiRec-master/src/model.py:66: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

time interval: 0.2292 min
default_13
iter: 2000, train loss: 6.2790, valid recall: 0.243718, valid ndcg: 0.374783, valid hitrate: 0.821720
time interval: 0.4520 min
default_13
iter: 3000, train loss: 5.9147, valid recall: 0.245617, valid ndcg: 0.377263, valid hitrate: 0.824825
time interval: 0.6773 min
default_13
iter: 4000, train loss: 5.7267, valid recall: 0.245985, valid ndcg: 0.377675, valid hitrate: 0.823958
time interval: 0.8961 min
default_13
iter: 5000, train loss: 5.5818, valid recall: 0.242054, valid ndcg: 0.369041, valid hitrate: 0.809084
time interval: 1.1137 min
default_13
iter: 6000, train loss: 5.4345, valid recall: 0.242857, valid ndcg: 0.374336, valid hitrate: 0.815005
time interval: 1.3261 min
default_13
iter: 7000, train loss: 5.2908, valid recall: 0.236174, valid ndcg: 0.369225, valid hitrate: 0.815366
time interval: 1.5408 min
default_13
iter: 8000, train loss: 5.1504, valid recall: 0.236316, valid ndcg: 0.378844, valid hitrate: 0.834573
time interval: 1.7565 min
default_13
iter: 9000, train loss: 5.0418, valid recall: 0.237421, valid ndcg: 0.383440, valid hitrate: 0.841794
time interval: 1.9801 min
default_13
iter: 10000, train loss: 4.9444, valid recall: 0.237286, valid ndcg: 0.387053, valid hitrate: 0.853275
time interval: 2.1986 min
default_13
iter: 11000, train loss: 4.8723, valid recall: 0.233209, valid ndcg: 0.382401, valid hitrate: 0.847787
time interval: 2.4189 min
default_13
iter: 12000, train loss: 4.8211, valid recall: 0.228057, valid ndcg: 0.382329, valid hitrate: 0.846704
time interval: 2.6472 min
default_13
iter: 13000, train loss: 4.7838, valid recall: 0.227484, valid ndcg: 0.378246, valid hitrate: 0.846632
time interval: 2.8738 min
default_13
iter: 14000, train loss: 4.7506, valid recall: 0.223084, valid ndcg: 0.374624, valid hitrate: 0.842516
time interval: 3.0927 min
default_13
iter: 15000, train loss: 4.7230, valid recall: 0.226985, valid ndcg: 0.380999, valid hitrate: 0.849881
time interval: 3.3098 min
default_13
iter: 16000, train loss: 4.7085, valid recall: 0.221697, valid ndcg: 0.375128, valid hitrate: 0.845982
time interval: 3.5368 min
default_13
iter: 17000, train loss: 4.6896, valid recall: 0.222674, valid ndcg: 0.376100, valid hitrate: 0.845115
time interval: 3.7690 min
default_13
iter: 18000, train loss: 4.6643, valid recall: 0.221301, valid ndcg: 0.371613, valid hitrate: 0.845548
time interval: 4.0020 min
default_13
iter: 19000, train loss: 4.6479, valid recall: 0.223086, valid ndcg: 0.374646, valid hitrate: 0.848798
time interval: 4.2382 min
default_13
iter: 20000, train loss: 4.6386, valid recall: 0.218383, valid ndcg: 0.371638, valid hitrate: 0.842299
time interval: 4.4733 min
default_13
iter: 21000, train loss: 4.6365, valid recall: 0.223499, valid ndcg: 0.374852, valid hitrate: 0.853780
time interval: 4.7124 min
default_13
iter: 22000, train loss: 4.6232, valid recall: 0.220512, valid ndcg: 0.369942, valid hitrate: 0.847715
time interval: 4.9466 min
default_13
iter: 23000, train loss: 4.6092, valid recall: 0.221700, valid ndcg: 0.370602, valid hitrate: 0.851903
time interval: 5.1836 min
default_13
iter: 24000, train loss: 4.5919, valid recall: 0.223463, valid ndcg: 0.371026, valid hitrate: 0.854069
time interval: 5.4180 min
default_13
iter: 25000, train loss: 4.5891, valid recall: 0.222053, valid ndcg: 0.368951, valid hitrate: 0.853275
time interval: 5.6556 min
default_13
iter: 26000, train loss: 4.5721, valid recall: 0.221527, valid ndcg: 0.368607, valid hitrate: 0.853997
time interval: 5.8915 min
default_13
iter: 27000, train loss: 4.5686, valid recall: 0.224152, valid ndcg: 0.368715, valid hitrate: 0.856018
time interval: 6.1233 min
default_13
iter: 28000, train loss: 4.5665, valid recall: 0.224374, valid ndcg: 0.369500, valid hitrate: 0.860134
time interval: 6.3609 min
default_13
iter: 29000, train loss: 4.5547, valid recall: 0.222282, valid ndcg: 0.365353, valid hitrate: 0.857535
time interval: 6.5944 min
default_13
iter: 30000, train loss: 4.5480, valid recall: 0.222672, valid ndcg: 0.366289, valid hitrate: 0.857824
time interval: 6.8299 min
default_13
iter: 31000, train loss: 4.5338, valid recall: 0.222845, valid ndcg: 0.366599, valid hitrate: 0.859196
time interval: 7.0677 min
default_13
iter: 32000, train loss: 4.5255, valid recall: 0.222299, valid ndcg: 0.368584, valid hitrate: 0.857102
time interval: 7.3032 min
default_13
iter: 33000, train loss: 4.5249, valid recall: 0.221746, valid ndcg: 0.365956, valid hitrate: 0.859268
time interval: 7.5379 min
default_13
iter: 34000, train loss: 4.5262, valid recall: 0.222314, valid ndcg: 0.367799, valid hitrate: 0.859340
time interval: 7.7660 min
default_13
iter: 35000, train loss: 4.5167, valid recall: 0.225088, valid ndcg: 0.368152, valid hitrate: 0.860279
time interval: 7.9954 min
default_13
iter: 36000, train loss: 4.5108, valid recall: 0.223023, valid ndcg: 0.367666, valid hitrate: 0.856813
time interval: 8.2277 min
default_13
iter: 37000, train loss: 4.5029, valid recall: 0.224739, valid ndcg: 0.367335, valid hitrate: 0.860640
time interval: 8.4546 min
default_13
iter: 38000, train loss: 4.5032, valid recall: 0.225920, valid ndcg: 0.368796, valid hitrate: 0.863239
time interval: 8.6820 min
default_13
iter: 39000, train loss: 4.4981, valid recall: 0.225088, valid ndcg: 0.366187, valid hitrate: 0.861290
time interval: 8.9166 min
default_13
iter: 40000, train loss: 4.4931, valid recall: 0.224267, valid ndcg: 0.366897, valid hitrate: 0.863095
time interval: 9.1485 min
default_13
iter: 41000, train loss: 4.5026, valid recall: 0.225910, valid ndcg: 0.367643, valid hitrate: 0.864611
time interval: 9.3777 min
default_13
iter: 42000, train loss: 4.4870, valid recall: 0.225368, valid ndcg: 0.367867, valid hitrate: 0.862662
time interval: 9.6139 min
default_13
iter: 43000, train loss: 4.4947, valid recall: 0.223234, valid ndcg: 0.365470, valid hitrate: 0.861434
time interval: 9.8442 min
default_13
iter: 44000, train loss: 4.4903, valid recall: 0.224897, valid ndcg: 0.367666, valid hitrate: 0.862517
time interval: 10.0736 min
default_13
iter: 45000, train loss: 4.4922, valid recall: 0.224667, valid ndcg: 0.366308, valid hitrate: 0.863311
time interval: 10.3043 min
default_13
iter: 46000, train loss: 4.4922, valid recall: 0.228815, valid ndcg: 0.371155, valid hitrate: 0.868366
time interval: 10.5328 min
default_13
iter: 47000, train loss: 4.4739, valid recall: 0.224469, valid ndcg: 0.367829, valid hitrate: 0.863311
time interval: 10.7601 min
default_13
iter: 48000, train loss: 4.4925, valid recall: 0.226125, valid ndcg: 0.368420, valid hitrate: 0.866561
time interval: 10.9903 min
default_13
iter: 49000, train loss: 4.4760, valid recall: 0.224007, valid ndcg: 0.367283, valid hitrate: 0.862734
time interval: 11.2274 min
default_13
iter: 50000, train loss: 4.4828, valid recall: 0.224401, valid ndcg: 0.365953, valid hitrate: 0.862373
time interval: 11.4566 min
default_13
iter: 51000, train loss: 4.4793, valid recall: 0.222735, valid ndcg: 0.363871, valid hitrate: 0.858474
time interval: 11.6930 min
default_13
iter: 52000, train loss: 4.4740, valid recall: 0.223598, valid ndcg: 0.363620, valid hitrate: 0.861362
time interval: 11.9258 min
default_13
iter: 53000, train loss: 4.4748, valid recall: 0.226314, valid ndcg: 0.367474, valid hitrate: 0.867716
time interval: 12.1512 min
default_13
iter: 54000, train loss: 4.4675, valid recall: 0.222753, valid ndcg: 0.362347, valid hitrate: 0.865117
time interval: 12.3826 min
default_13
iter: 55000, train loss: 4.4685, valid recall: 0.223486, valid ndcg: 0.366220, valid hitrate: 0.862806
model restored from best_model/default_13/
valid recall: 0.245985, valid ndcg: 0.377675, valid hitrate: 0.823958, valid diversity: 0.000000
test recall: 0.250405, test ndcg: 0.377905, test hitrate: 0.829386, test diversity: 0.000000
